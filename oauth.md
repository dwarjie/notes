# OAuth 2.0

OAuth 2.0 is an authorization framework that simplifies sharing of user data between different applications. It also addresses the API Security concerns, sharing of user credentials while providing a simple flow for web, mobile, desktop and other technologies.

## History of OAuth 2.0

Back in the days, users are required to share their username, email, and passwords. Which shows a lot of holes when it comes to security privacy. That's why, a community in 2007 and currently developed and maintained by Internet Engineering Task Force (IETF) same up with a token based authorization mechanism.

Here are several examples of security issues when it comes to old way:
- User Credential Exposure: Since users are required to share their username and password that are saved in a database, there is a possibility that the database are not secured and vulnerable in the event of a breach.
- Scope of Access: The application that you are using has access to all of your data that you do not wish to share. By having OAuth, you have limit the data they can access.
- No way to revoke access: Users cannot easily revoke their data from the application since they do not have any access to the database. By having OAuth, you can easily revoke all third-party applications access to your data.

## Roles Involved in OAuth Flow:

- Resource Owner: The user (YOU) who is granting a third-party access to their data.
- Client: This is the third-party application (your app that you are developing) that is requesting access to the Resource Owner data. Once the Resource Owner grants access, the client will receive a token that can be used to request the resources needed within the given SCOPE.
- Authorization Server: The authorization server acts as the middle man between client, resource owner, and resource server by issuing access token to the client after the resource ownser authorizes the request.
- Resource Server: This is the server that holds all the data/resources needed by the client (e.g., github, google, etc.). It is responsible for accepting and responding to the request of the client using an access token.

Here is a simple diagram that shows an OAuth Flow: ![OAuth Flow](https://blog.postman.com/wp-content/uploads/2023/08/OAuth-2.0.png)

## Implementation with Web Apps

### Authorization
When creating a Log In link and asks for authorization from the user, here's an example of the needed parameters for the link:
```
https://authorization-server.com/auth?response_type=code&client_id=CLIENT_ID&redirect_uri=REDIRECT_URI&scope=photos&state=1234zyx
```
- response_type=code: Indicates the server expects to receive an authorization code
- client_id: The ID of the Client (third-party application)
- redirect_uri: The callback url to redirect the users once the authorization is complete
- scope: One or more scope values indicating what you wish to access
- state: A random string generated by your application which you'll verify later.

Once the user grants an access to the Client (clicking the allow button), the server will receive the following data:
```
https://example-app.com/cb?code=AUTH_CODE_HERE&state=1234zyx
```
- code: The authorization code represented in string
- state: The same state value that was provided earlier

Ideally, you may want to compate both state value if it matches the once you have provided earlier. This helps to ensure you redirection endpoint isn't able to be tricked into attempting to set arbitraty authorization codes.

Now that the you have the Authorization Code, the next step is requesting an access token to the authorization server by using the response code. You have to make a POST request to the authorization server with the following details:
```
POST https://api.authorization-server.com/token
  grant_type=authorization_code&
  code=AUTH_CODE_HERE&
  redirect_uri=REDIRECT_URI&
  client_id=CLIENT_ID&
  client_secret=CLIENT_SECRET
```
- grant_type=authorization_code: The type of authorization you will be using. In this case, we will be using a code
- code=AUTH_CODE_HERE: The authorization code you have received earlier
- redirect_uri=REDIRECT_URI: Must be identical to the redirect_uri you have provided earlier
- client_id: The client ID you have indicated earlier
- client_secret: Secret string provided by client server

Once successfull, you wil receive an access token you may use to access the data from the resource server and expiration time.
```
{
  "access_token":"RsT5OjbzRn430zqMLgV3Ia",
  "expires_in":3600
}
```
